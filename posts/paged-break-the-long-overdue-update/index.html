<!DOCTYPE html>



<html lang=" en" class="no-js">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">

<title>Paged.js — Paged Break, the long overdue update</title>

<script type="module">
document
.documentElement
.classList
.remove('no-js');
document
.documentElement
.classList
.add('js');
</script>
<meta name="description" content="">
<meta property="og:title" content="Paged Break, the long overdue update — ">
        <meta property="og:description" content="">
        <meta property="og:image" content="">
        <meta property="og:image:alt" content="Image description">
        <meta property="og:locale" content="en_GB">
        <meta property="og:type" content="website">
        <meta name="twitter:card" content="summary_large_image">
        <meta property="og:url" content="site.url">
        <link rel="canonical" href="https://www.mywebsite.com/page">

        <link rel="icon" href="/favicon.ico">
        <link rel="icon" href="/favicon.svg" type="image/svg+xml">
        <link rel="apple-touch-icon" href="/apple-touch-icon.png">
        <link rel="manifest" href="/my.webmanifest">
        <meta name="theme-color" content="NaN">

        
        <meta name="twitter:dnt" content="on">
        
            

        

        
            <link rel="stylesheet" href="/css/theme-pagedjs/main.css">
        

        <link href="https://unpkg.com/prismjs@1.20.0/themes/prism.css" rel="stylesheet">
        <script>

        // if there is a dark mode in the storage, use that
        if (localStorage.getItem('Nightmode') == "true") {
        document
        .documentElement
        .classList
        .add('nightmode')
        }
        </script>

        

            <script>

  if (window.location.href.includes("?night")) {
    document.documentElement.classList.add("nightmode");
  }

function start() {

    document.querySelectorAll("a").forEach((a) => {
      if (a.href.includes(`?day`)) {
        // add the infor mation in the url of each link
        a.href = `${a.href.replace("?day", "?night")}`;
      } else if (a.href.includes("#")) {
        a.href = a.href.replace("#", "index.html?night#");
      } else {
        a.href = `${a.href}?night`;
      }
    });
};

start()
</script>

        
        </head>

        <body  class=" " style="">

        <div class="crop-marks">
    <div class="crop-mark vertical"></div>
    <div class="crop-mark horizontal"></div>
    <div class="paper"></div>
</div>

        

        
            <div class="running-head">

        
    
    <a class="back-home" href="/">
        
    <svg id="paged-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 213 52" fill="none" id="paged-logo"><path fill="var(--color-body)" d="M69.1 34.7c0 1.3-.5 2.7-1.6 2.7s-1.6-1.1-1.6-4.6v-7.1c0-7.3-1.5-13.5-12.1-13.5-6.5.0-13.4 2.2-13.4 8.4.0 4.7 6.9 6.1 9.9 2.6-1-1.3-1.7-3-1.7-4.5.0-2.9 2.2-3.5 4.4-3.5 2.4.0 3.9 1.4 3.9 8.6v1.3l-4.1 1.1c-7.9 2.2-12.9 4.9-12.9 9.1.0 3.9 2.2 6 7.1 6 4.6.0 8.7-2.4 11-7.7h.5c.9 5 2.4 7.7 6.8 7.7 3.1.0 6.6-1.5 6.1-6.7h-2.3v.1zm-17.8 1.8c-1.7.0-2.6-.9-2.6-2.1.0-3.2 2.3-4.7 8.2-6.5.1 4-2.5 8.6-5.6 8.6zM24.8 12.3c-3.6.0-9.6 1.2-10.6 9.1h-.9v-9.1L.9 15.2v2.4h6v31l-5.4.4v2.4h20.2V49l-6.2-.5V37.3c1.3 1.9 4 4.2 8.7 4.2 5.1.0 12.3-4.4 12.3-14.2.0-9.2-5.1-15-11.7-15zm-2.4 25.2c-2.8.0-5.3-1.5-6.5-5.7v-8.9c.1-1.3 1.5-5.4 5-5.4 4.4.0 7 5.1 7 10.5-.1 4.7-2 9.5-5.5 9.5zm155-21.6h5.8v32c0 3.4-4.3.4-5.1-3.1H177c-1.3 3.5-.2 6.9 3.1 6.9 3.2.0 7.4-1.7 7.4-8.9l.1-30.6-10.2 1.4v2.3zm-6 17.9c-2.4.0-3.7 1.3-3.7 3.7.0 2.4 1.3 3.7 3.7 3.7 2.4.0 3.7-1.3 3.7-3.7.0-2.4-1.4-3.7-3.7-3.7zM95.8 37.4c-4.9-1.1-12.3-1.1-15.9-1.6l1.2-2.4c1.4.4 3.1.6 5 .6 8.6.0 13.3-4.9 13.3-11.3.0-4.4-3-8-7.8-9.6l.2-.6c1.9.4 3.9.7 5.4.7 2.3.0 4-.8 4-3.4.0-1.8-1.3-4.1-3.3-6.2-3.3 3.6-6.2 7.3-10.7 8.7-.2-.1-.4-.1-.6-.1-8.6.0-13 4.8-13 11.3.0 4 1.8 7.4 5.7 9.2l-5.5 4.6c.4.8 1.7 2.9 6.5 4.4v.7c-4.4.6-7 1.9-7 3.7.0 3.8 7 5.7 12.3 5.7 9.1.0 16.6-2.3 16.9-7.9.0-3.6-1.6-5.4-6.7-6.5zm-10-22.2c3.3.0 4.8 2.4 4.8 7.4.0 5.7-1.1 8.5-4 8.5-3.4.0-4.8-2.9-4.8-8.4.1-5.3 1.2-7.5 4-7.5zm5.1 32.5c-6.2.0-10.5-1.5-10.5-3.2.0-.6.6-1.3 1.8-2.2l.9.2c9.4 1.8 14.8 1.3 14.8 3 .1 1.4-2.5 2.2-7 2.2zM199 21.5c-2.3-1.4-3.3-2.6-3.3-4 0-1.6 1.1-3.3 4-3.3 4.3.0 8.1 3.6 10.6 8.9h1.1v-8.4c-3-1.6-6.4-2.4-9.5-2.4-5.3.0-9.8 2.4-9.8 7.3.0 3.9 3.1 6.7 6.2 8.4 5.8 3.2 11 4.4 11 7.8.0 2.3-2.2 3.6-4.7 3.6-5.2.0-8.9-2.7-10.9-10.2h-1.1v9.4c2.7 1.8 6.5 2.8 10.1 2.8 5.4.0 10.2-2.2 10.2-7.7.1-6.5-7.5-8.3-13.9-12.2zM185.7 1.8c-2 0-2.9 1.1-2.9 2.9.0 1.9 1 2.9 2.9 2.9 1.8.0 2.9-1 2.9-2.9s-1.1-2.9-2.9-2.9zM126.1 29.1c.1.4.1.7.1 1.1.0 3.9-2.8 6.1-6.8 6.1-3.9.0-6.7-2.8-7.7-8.5l17.2-4.3c-.2-7.7-4.7-11.3-12.9-11.3-6.2.0-13 4.5-13 14.4.0 7.5 4.9 14.6 13.9 14.6 8 0 12.3-5.3 12.3-11.2.0-.5-.1-1-.1-1.5l-3 .6zm-14.7-5.8c0-5.2 2.2-8 5.3-8 2.9.0 3.8 3.2 3.8 5.6.0 1.5-1.9 1.8-5.1 2.9l-4 1.3v-1.8zM147 4.7l6.2.5v10.6c-1.5-2.1-4-3.6-8.4-3.6-5.1.0-12.3 4.4-12.3 14.2.0 9.1 5.1 14.9 11.7 14.9 3.6.0 9.6-1.2 10.6-9.1h1l1.9 8.3h4V.8l-14.8 1.5v2.4h.1zm6.2 26c-.1 1.2-1.1 5.4-5.9 5.4-4 0-6-4.9-6-10.5.0-4.7 1.9-9.5 5.4-9.5 2.8.0 5.3 1.5 6.5 5.7v8.9z"></path></svg>    

    </a>
    
    <button class="menu-call">MENU</button>
    <nav class="menu hide" role="main">
        <ul>

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                
                    <li  class="">
                        <a href="/about/">about</a>
                    </li>
                

            
                
                    <li  class="">
                        <a href="/frequently-asked-questions-about-paged.js.html">FAQ</a>
                    </li>
                

            
                
                    <li  class="">
                        <a href="/documentation/">documentation</a>
                    </li>
                

            
                
                    <li  class="">
                        <a href="/made-with-paged.js.html">examples</a>
                    </li>
                

            
                

            
                
                    <li  class="">
                        <a href="/posts/">journal</a>
                    </li>
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            

            <li>
                <a class="gitlab-link" href="https://gitlab.coko.foundation/pagedjs/pagedjs/">Gitlab</a>
            </li>
        </ul>
    </nav>

</div>


        

        
  


         
  
  <header>
    <h1 id="title">
        
        Paged Break, the long overdue update
    </h1>
    
      <p class="meta">written 
        by <span class="author">Julien Taquet</span>
        on <time class="date">7/10/2022</time>
      </p>        
    
  </header>  
  <article>
    
      <p class="intro">Paged.js has been through a lot of changes over  the last year or so. And those were quite interesting to navigate. Let’s see where we’re at.
        
          <br>  
            <span class="tags">
              
                <a class=  "tag" href="/tags/breaking changes/">breaking changes</a>
              
                <a class=  "tag" href="/tags/guide/">guide</a>
              
                <a class=  "tag" href="/tags/release notes/">release notes</a>
              
            </span>
                  
        
    
    <p>It’s been a while, hasn’t it?</p>
<p>That’s how it feels for us. Not that we weren’t around working, quite the opposite to be honest, but it wasn’t very visible outside of the <a href="https://mattermost.coko.foundation">Coko chat</a> (You should join if you’re interested in the future of Paged.js as we try more and more to discuss things in the open out there). We also try to offer some news on <a href="https://twitter.com/paged_js">Twitter</a>, so make sure to follow if you want some last-minute news, or if you want to ask some questions a little bit.</p>
<p>Still, it feels nice to fill those pages after a year of being silent so let’s try to catch up to what happened as we’ve been a tiny bit busy.</p>
<p>Before we get into that, we had to move our repo from the GitLab we had at <a href="http://pagedmedia.org">pagedmedia.org</a> to <a href="http://localhost:8080/posts/paged-break-the-long-overdue-update/">https://gitlab.coko.foundation</a>. Because Paged.js is maintained by the <a href="https://coko.foundation">Coko Foundation</a> and also because we got hit quite hard by a crazy spam that literally killed the server again and again. We’re now in a much better space as the nice folks of <a href="https://cloud68.co">cloud68.co</a> are now in charge of making our life easier, and they’re quite good at it. We managed to save the important repos and all the comments and conversations, thanks to Boris.</p>
<p>Ok, back to Paged.js</p>
<p>Between June last year and this month of July, we’ve been through a lot of small changes, going from 0.2.0 to 0.4.1 beta (we do have beta now!)</p>
<p>Before explaining the changes, a small shout-out to our friendly users who came up with fixes. So thanks to Anthony Libotte, Guillaume Grossetie, Thomas Parisot, Angela Liu to name a few (along with the amazing work from Fred Chasen).</p>
<p>We won’t spend too much time on the small fixes as they’re mostly updates to preexising features, including, better support for footnotes, a new div to be able to center things vertically, and those kinds of things. The release note for each merge request tells more than what I could write here.</p>
<p>But then, here are the breaking changes.</p>
<h2 id="goodbye-web2print%2C-hello-web%2Bprint" tabindex="-1">Goodbye web2print, hello web+print</h2>
<p>A reminder: Paged.js is a polyfill, a Javascript library that does what the browser should be doing by itself. That means that what you do with Paged.js today needs to be what you will be able to do in Chromium, Firefox, Edge, Vivaldi, etc in future -- one day, the browsers will have implemented the print feature and when that happens, we won’t need Paged.js anymore</p>
<p>To be a working polyfill, Paged.js needs to work exactly like a browser.</p>
<p>In a browser, when we set @media queries, we can define styles for a specific environment. We know that well because that’s how responsive design works: you define what happens when the usable surface is smaller than 800px @media (max-width: 800px) or when night mode is wanted  @media (prefers-color-scheme: dark) or simply when you want to print something with @media print.</p>
<p>If you don’t set any query, then your CSS will be used in all situations.</p>
<p>So a simple example: we have some <code>&lt;h1&gt;</code> and we want them to have a font-size of 2em in all situations, but we want them red on screen, black on paper. This is how it will be set.</p>
<pre class="language-css"><code class="language-css"><span class="token comment">/* shared for all the context */</span>  <br><span class="token selector">h1</span> <span class="token punctuation">{</span>  <br>  <span class="token property">font-size</span><span class="token punctuation">:</span> 2em<span class="token punctuation">;</span>  <br><span class="token punctuation">}</span>  <br>  <br><span class="token comment">/* only for screen */</span>  <br><span class="token atrule"><span class="token rule">@media</span> screen</span> <span class="token punctuation">{</span>  <br>  <span class="token selector">h1</span> <span class="token punctuation">{</span>  <br>    <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>  <br>  <span class="token punctuation">}</span>  <br><span class="token punctuation">}</span>  <br>  <br><span class="token comment">/* only for print */</span>  <br><span class="token atrule"><span class="token rule">@media</span> print</span> <span class="token punctuation">{</span>  <br>  <span class="token selector">h1</span> <span class="token punctuation">{</span>  <br>    <span class="token property">color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>  <br>  <span class="token punctuation">}</span>  <br><span class="token punctuation">}</span></code></pre>
<p>Until now, you needed to have a custom stylesheet for pagedjs to handle what happens in print and on screen. If there were some styles defined for the screen in the stylesheet, they were also rendered in the preview.</p>
<p>In the example above, it takes the latest value defined in the CSS cascade:  the h1 would be black on screen and on paper.</p>
<p>That’s the result of rendering the print preview on screen, creating the perfect paradox where eveything is used. Paged.js tricked the browser to show you the styles from the CSS for print, in a screen context, because we preview those pages, on a screen.</p>
<p>Now, with this new feature, Paged.js will  hide what’s for the screen and show what will be printed. Starting with version 0.4.1, Paged.js will stop parsing any css that is inside a @media screen media query. In other words:</p>
<pre class="language-css"><code class="language-css"><span class="token comment">/* This will be completely remove from the page when you run Paged.js */</span>  <br><span class="token atrule"><span class="token rule">@media</span> screen</span> <span class="token punctuation">{</span>  <br>  <span class="token selector">p</span> <span class="token punctuation">{</span>  <br>    <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>  <br>  <span class="token punctuation">}</span>  <br><span class="token punctuation">}</span>  <br>  <br><span class="token comment">/* this will be used by Paged.js */</span>  <br><span class="token atrule"><span class="token rule">@media</span> print</span> <span class="token punctuation">{</span>  <br>  <span class="token selector">p</span> <span class="token punctuation">{</span>  <br>    <span class="token property">color</span><span class="token punctuation">:</span> purple<span class="token punctuation">;</span>  <br>  <span class="token punctuation">}</span>  <br><span class="token punctuation">}</span>  <br>  <br><span class="token comment">/* this will be used by Paged.js as it an equivalent of @media all */</span>  <br><span class="token selector">p</span> <span class="token punctuation">{</span>  <br>  <span class="token property">color</span><span class="token punctuation">:</span> purple<span class="token punctuation">;</span>  <br><span class="token punctuation">}</span></code></pre>
<p>But as we’re moving toward html AND print, we needed to change Paged.js a bit. In the previous <a href="https://pagedjs.org/posts/2020-04-15-starterkits-for-pagedjs/">post from Julie</a>, she showed how we could create a designer interface around the paged.js preview feature: show baseline, show margin boxes, etc. To make that work, she added content as a hook: when paged.js was done, it would show the toolbar, making it hard to work with (and absolutely not standard). This update will change that.</p>
<p>So now, if you want to use the polyfill and have have elements just for the screen preview, you can use one of the following ways:</p>
<p>Put all the interface rules in a seperate stylesheet that has a media=&quot;screen&quot; attribute, which won’t be parsed by the polyfill and only applied to screen media:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>screen.css<span class="token punctuation">"</span></span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>screen<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></code></pre>
<p>Or add a media=&quot;screen&quot; attribute to any style tag to apply those rules to screen media and be ignored by Pagedjs:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">media</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>screen<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">  <br>  <span class="token selector">p</span> <span class="token punctuation">{</span>  <br>    <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>  <br>  <span class="token punctuation">}</span>  <br></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span></code></pre>
<p>Additionally, you can tell Paged.js to ignore <em>any</em> CSS you don’t want parsed with the pagedjs-ignore attribute:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">pagedjs-ignore</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">add some inline styles</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span>  <br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/css<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>screen.css<span class="token punctuation">"</span></span> <span class="token attr-name">pagedjs-ignore</span><span class="token punctuation">></span></span></code></pre>
<p>This way, pagedjs will pass the stylesheet as it is, and will not update the styles. One important note: if you are ignoring screen styles, you want to make sure that you’re writing in a media screen to avoid the styles being mixed up on export.</p>
<p>Finally, in a parsed CSS file, adding <code>pagedjs-ignore</code> will skip a media block, passing it as it is to the browser. This is pretty useful to define how the page will look in the browser:</p>
<pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@media</span> screen<span class="token punctuation">,</span> pagedjs-ignore</span> <span class="token punctuation">{</span>  <br>  <span class="token selector">.pagedjs_pages</span> <span class="token punctuation">{</span><span class="token property">margin-top</span><span class="token punctuation">:</span> 20em<span class="token punctuation">}</span>  <br><span class="token punctuation">}</span>  <br>  <br><span class="token atrule"><span class="token rule">@media</span> pagedjs-ignore</span> <span class="token punctuation">{</span>  <br>  // block to pass  <br><span class="token punctuation">}</span></code></pre>
<p>One fair warning, this is a bit outside of the standard, it’s a usable workaround that we’ll support by default, but pagedjs-ignore has no intention of being a standard in the future. But it’s a way for you to build the tool you need around real media queries support.</p>
<p>You can test it already if you’re using Paged.js 0.4.0-beta.1, using the interface.css polyfill: <a href="https://gitlab.coko.foundation/pagedjs/interface-polyfill">https://gitlab.coko.foundation/pagedjs/interface-polyfill</a></p>
<p>We’ll let that work as a beta for a month before making a proper release.</p>
<p>The simplest way to use it is to get the file from unpkg cdn: <a href="https://unpkg.com/browse/pagedjs@0.4.0-beta.1/dist/">https://unpkg.com/browse/pagedjs@0.4.0-beta.1/dist/</a> and see how things work for you.</p>
<p>If you find any issues, or anything, feel free to open an issue on our GitLab, or contact us on the <a href="https://mattermost.coko.foundation">Mattermost</a> (again, the best way to get in touch with us.)</p>
<p>We’ll be back soon with some other updates, as Paged.js CLI also got pimped up! if you want to test the CLI with the aforementioned changes to Paged.js, you’ll find the files here: <a href="https://unpkg.com/browse/pagedjs-cli@0.2.2-beta.2/">https://unpkg.com/browse/pagedjs-cli@0.2.2-beta.2/</a></p>
<p>One last thing, 27-28 October 2022 in San Francisco will see the first <em>Page Break Conf</em> which has been organized by some great folks of our community. We’ll be back to talk a bit more about it soonish, so don’t forget to save the date!</p>
<p>Have a nice printing!</p>

  </article>
    

    
      
      
      <aside class="paginator  both ">
        <a class="previous" href="/posts/2020-04-15-starterkits-for-pagedjs/">A collection of starter kits for Paged.js </a>
        <a class="next" href="/posts/so-long-@media-screen!/">So long @media screen!</a>
      </aside>



        
            <footer><p class="foot-content">Paged.js is maintained by the nice folks at
<a href="https://coko.foundation" class="footer-logo">Coko</a>.</p></footer>

        

        
        
        

        
        <script>

        if (document.querySelector('.toc .title')) {
        document.querySelector('.toc .title').addEventListener("click", function() {
        document.querySelector('.toc').classList.toggle("show");
        })
        }

        document.querySelector(".menu-call").addEventListener("click", function() {document.querySelector(".menu").classList.toggle("hide")});


        </script>
        
        <!-- 
        Donation nation
        -->

        <script>
        (function () {
        if (document.querySelector('.commitchange-donate[data-fixed]')) 
        return;
        var cc_donate = document.createElement('div');
        cc_donate.innerHTML = "<a data-fixed class='commitchange-donate'></a>";
        document
        .body
        .appendChild(cc_donate);
        var npo = 5726;
        var script = document.createElement('script');
        var first = document.getElementsByTagName('script')[0];
        script.setAttribute('data-npo-id', npo);
        script.id = 'commitchange-script';
        script.src = 'https://us.commitchange.com/js/donate-button.v2.js';
        first
        .parentNode
        .insertBefore(script, first);
        })();


        </script>
        </body>
        </html>
