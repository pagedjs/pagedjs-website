<!DOCTYPE html>



<html lang=" en" class="no-js">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">

<title>Paged.js — Uke and inks</title>

<script type="module">
document
.documentElement
.classList
.remove('no-js');
document
.documentElement
.classList
.add('js');
</script>
<meta name="description" content="">
<meta property="og:title" content="Uke and inks — ">
        <meta property="og:description" content="">
        <meta property="og:image" content="">
        <meta property="og:image:alt" content="Image description">
        <meta property="og:locale" content="en_GB">
        <meta property="og:type" content="website">
        <meta name="twitter:card" content="summary_large_image">
        <meta property="og:url" content="site.url">
        <link rel="canonical" href="https://www.mywebsite.com/page">

        <link rel="icon" href="/pagedjs-website/favicon.ico">
        <link rel="icon" href="/pagedjs-website/favicon.svg" type="image/svg+xml">
        <link rel="apple-touch-icon" href="/pagedjs-website/apple-touch-icon.png">
        <link rel="manifest" href="/pagedjs-website/my.webmanifest">
        <meta name="theme-color" content="NaN">

        
        <meta name="twitter:dnt" content="on">
        
            

        

        
            <link rel="stylesheet" href="/pagedjs-website/css/theme-pagedjs/main.css">
        

        <link href="https://unpkg.com/prismjs@1.20.0/themes/prism.css" rel="stylesheet">
        <script>

        // if there is a dark mode in the storage, use that
        if (localStorage.getItem('Nightmode') == "true") {
        document
        .documentElement
        .classList
        .add('nightmode')
        }
        </script>

        

            <script>

  if (window.location.href.includes("?night")) {
    document.documentElement.classList.add("nightmode");
  }

function start() {

    document.querySelectorAll("a").forEach((a) => {
      if (a.href.includes(`?day`)) {
        // add the infor mation in the url of each link
        a.href = `${a.href.replace("?day", "?night")}`;
      } else if (a.href.includes("#")) {
        a.href = a.href.replace("#", "index.html?night#");
      } else {
        a.href = `${a.href}?night`;
      }
    });
};

start()
</script>

        
        </head>

        <body class="cookbook " style="">

        <div class="crop-marks">
    <div class="crop-mark vertical"></div>
    <div class="crop-mark horizontal"></div>
    <div class="paper"></div>
</div>

        

        
            <div class="running-head">

        
    
    <a class="back-home" href="/pagedjs-website/">
        
    <svg id="paged-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 213 52" fill="none"><path fill="var(--color-body)" d="M69.1 34.7c0 1.3-.5 2.7-1.6 2.7s-1.6-1.1-1.6-4.6v-7.1c0-7.3-1.5-13.5-12.1-13.5-6.5.0-13.4 2.2-13.4 8.4.0 4.7 6.9 6.1 9.9 2.6-1-1.3-1.7-3-1.7-4.5.0-2.9 2.2-3.5 4.4-3.5 2.4.0 3.9 1.4 3.9 8.6v1.3l-4.1 1.1c-7.9 2.2-12.9 4.9-12.9 9.1.0 3.9 2.2 6 7.1 6 4.6.0 8.7-2.4 11-7.7h.5c.9 5 2.4 7.7 6.8 7.7 3.1.0 6.6-1.5 6.1-6.7h-2.3v.1zm-17.8 1.8c-1.7.0-2.6-.9-2.6-2.1.0-3.2 2.3-4.7 8.2-6.5.1 4-2.5 8.6-5.6 8.6zM24.8 12.3c-3.6.0-9.6 1.2-10.6 9.1h-.9v-9.1L.9 15.2v2.4h6v31l-5.4.4v2.4h20.2V49l-6.2-.5V37.3c1.3 1.9 4 4.2 8.7 4.2 5.1.0 12.3-4.4 12.3-14.2.0-9.2-5.1-15-11.7-15zm-2.4 25.2c-2.8.0-5.3-1.5-6.5-5.7v-8.9c.1-1.3 1.5-5.4 5-5.4 4.4.0 7 5.1 7 10.5-.1 4.7-2 9.5-5.5 9.5zm155-21.6h5.8v32c0 3.4-4.3.4-5.1-3.1H177c-1.3 3.5-.2 6.9 3.1 6.9 3.2.0 7.4-1.7 7.4-8.9l.1-30.6-10.2 1.4v2.3zm-6 17.9c-2.4.0-3.7 1.3-3.7 3.7.0 2.4 1.3 3.7 3.7 3.7 2.4.0 3.7-1.3 3.7-3.7.0-2.4-1.4-3.7-3.7-3.7zM95.8 37.4c-4.9-1.1-12.3-1.1-15.9-1.6l1.2-2.4c1.4.4 3.1.6 5 .6 8.6.0 13.3-4.9 13.3-11.3.0-4.4-3-8-7.8-9.6l.2-.6c1.9.4 3.9.7 5.4.7 2.3.0 4-.8 4-3.4.0-1.8-1.3-4.1-3.3-6.2-3.3 3.6-6.2 7.3-10.7 8.7-.2-.1-.4-.1-.6-.1-8.6.0-13 4.8-13 11.3.0 4 1.8 7.4 5.7 9.2l-5.5 4.6c.4.8 1.7 2.9 6.5 4.4v.7c-4.4.6-7 1.9-7 3.7.0 3.8 7 5.7 12.3 5.7 9.1.0 16.6-2.3 16.9-7.9.0-3.6-1.6-5.4-6.7-6.5zm-10-22.2c3.3.0 4.8 2.4 4.8 7.4.0 5.7-1.1 8.5-4 8.5-3.4.0-4.8-2.9-4.8-8.4.1-5.3 1.2-7.5 4-7.5zm5.1 32.5c-6.2.0-10.5-1.5-10.5-3.2.0-.6.6-1.3 1.8-2.2l.9.2c9.4 1.8 14.8 1.3 14.8 3 .1 1.4-2.5 2.2-7 2.2zM199 21.5c-2.3-1.4-3.3-2.6-3.3-4 0-1.6 1.1-3.3 4-3.3 4.3.0 8.1 3.6 10.6 8.9h1.1v-8.4c-3-1.6-6.4-2.4-9.5-2.4-5.3.0-9.8 2.4-9.8 7.3.0 3.9 3.1 6.7 6.2 8.4 5.8 3.2 11 4.4 11 7.8.0 2.3-2.2 3.6-4.7 3.6-5.2.0-8.9-2.7-10.9-10.2h-1.1v9.4c2.7 1.8 6.5 2.8 10.1 2.8 5.4.0 10.2-2.2 10.2-7.7.1-6.5-7.5-8.3-13.9-12.2zM185.7 1.8c-2 0-2.9 1.1-2.9 2.9.0 1.9 1 2.9 2.9 2.9 1.8.0 2.9-1 2.9-2.9s-1.1-2.9-2.9-2.9zM126.1 29.1c.1.4.1.7.1 1.1.0 3.9-2.8 6.1-6.8 6.1-3.9.0-6.7-2.8-7.7-8.5l17.2-4.3c-.2-7.7-4.7-11.3-12.9-11.3-6.2.0-13 4.5-13 14.4.0 7.5 4.9 14.6 13.9 14.6 8 0 12.3-5.3 12.3-11.2.0-.5-.1-1-.1-1.5l-3 .6zm-14.7-5.8c0-5.2 2.2-8 5.3-8 2.9.0 3.8 3.2 3.8 5.6.0 1.5-1.9 1.8-5.1 2.9l-4 1.3v-1.8zM147 4.7l6.2.5v10.6c-1.5-2.1-4-3.6-8.4-3.6-5.1.0-12.3 4.4-12.3 14.2.0 9.1 5.1 14.9 11.7 14.9 3.6.0 9.6-1.2 10.6-9.1h1l1.9 8.3h4V.8l-14.8 1.5v2.4h.1zm6.2 26c-.1 1.2-1.1 5.4-5.9 5.4-4 0-6-4.9-6-10.5.0-4.7 1.9-9.5 5.4-9.5 2.8.0 5.3 1.5 6.5 5.7v8.9z"></path></svg>    

    </a>
    
    <button class="menu-call">MENU</button>
    <nav class="menu hide" role="main">
        <ul>

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                
                    <li class="">
                        <a href="/pagedjs-website/about/">about</a>
                    </li>
                

            
                
                    <li class="">
                        <a href="/pagedjs-website/frequently-asked-questions-about-paged.js.html">FAQ</a>
                    </li>
                

            
                
                    <li class="">
                        <a href="/pagedjs-website/documentation/">documentation</a>
                    </li>
                

            
                
                    <li class="">
                        <a href="/pagedjs-website/made-with-paged.js.html">examples</a>
                    </li>
                

            
                

            
                
                    <li class="">
                        <a href="/pagedjs-website/posts/">journal</a>
                    </li>
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            
                

            

            <li>
                <a class="gitlab-link" href="https://gitlab.coko.foundation/pagedjs/pagedjs/">Gitlab</a>
            </li>
        </ul>
    </nav>

</div>


        

        
  


         
  
  <header>
    <h1 id="title">
        
        Uke and inks
    </h1>
    
      <p class="meta">written 
        by <span class="author">Julien Taquet</span>
        on <time class="date">6/18/2021</time>
      </p>        
    
  </header>  
  <article>
    
      <p class="intro">Last month, I was asked by Adam to summarise the new options offered by Coko&#39;s Editoria export-to-PDF feature. It&#39;s rare to get to choose the subject you want to talk about, so as I&#39;m in the middle of building my home studio, I&#39;ll also talk about my ukulele.
        
          <br>  
            <span class="tags">
              
                <a class="tag" href="/pagedjs-website/tags/hooks/">hooks</a>
              
                <a class="tag" href="/pagedjs-website/tags/custom js/">custom js</a>
              
            </span>
                  
        
    
    </p><h2 id="editoria%2C-the-book-production-center" tabindex="-1">Editoria, the Book Production Center</h2>
<p>Editoria is a platform to collaboratively produce books, offering spaces for writers, editors, designers, etc. at the same time the content is being added.</p>
<p>We’ve been talking Editoria quite a lot in these pages. Firstly because Paged.js was implemented in Editoria before any other tool, after years of trying out other tools to make books out of HTML.</p>
<p>Editoria has been used for quite a while by Book Sprints and other friendly folks. It’s a pretty amazing tool for creating books collaboratively by a team. But one of the limitations from the designer’s perspective was that we were stuck with what CSS allowed us to do. It took quite a while to figure out the best option to have custom javascript hooks without compromising the security of the whole platform.</p>
<p>Well, that solution exists now:)</p>
<p>To show what you can do with Editoria nowadays, I have produced a small demo book, with some paged.js hooks that I explain in this post.</p>
<p>Before jumping into hooks, let’s briefly explain how paged.js does what it does.</p>
<h3 id="paged.js%3A-hooks-and-order" tabindex="-1">Paged.js: hooks and order</h3>
<p>Fred Chasen made paged.js around a clever idea: instead of defining the order of events that paged.js needed, he defined the moments where you would need to do something on the content, and set those as hooks to which you can bind your scripts.</p>
<p>All the modules use those entry points to do different things at different moments.</p>
<ol>
<li>
<p>when it’s about to parse the HTML, CSS and JS.</p>
</li>
<li>
<p>when all the content has been parsed.</p>
</li>
<li>
<p>when you create a new page</p>
</li>
<li>
<p>when you put one element on the page</p>
</li>
<li>
<p>when the page is filled and there is no more space left on the page</p>
</li>
<li>
<p>when you define the exact location your content is split</p>
</li>
<li>
<p>when you finish the layout of the page (go back to 3)</p>
</li>
<li>
<p>when you zend the signal that all pages are generated if there is no
content left.</p>
</li>
</ol>
<p>You can see all the existing hooks <a href="https://www.pagedjs.org/documentation/11-hooks/#some-informations-about-the-hooks">on this page</a> if you want to go deeper.</p>
<p>For example, let’s look at how a <code>break-before: left</code> is defined.</p>
<ol>
<li>Before the HTML, CSS and JS of the document is parsed.</li>
</ol>
<p><em>check if any element has a <code>break-before</code> property and if it’s value is <code>left</code>, add a <code>data-break-before: left</code> attribute to it.</em></p>
<ol start="4">
<li>when you lay out one element on the page</li>
</ol>
<p><em>if that element has a <code>data-break-before: left</code> attribute, stop adding elements to that page and jump to 6. Then, if it’s a right page create an <code>blank</code> page and resume adding content on the following page, else (if it’s a left page), resume adding the content.</em></p>
<p>As you can see, the algorithm is crystal clear, and when the browser handles features, we’ll be able to remove those that become useless over time.</p>
<p>Let’s start strumming our <s>ukulele</s> keyboard and make some code. :)</p>
<h2 id="where-the-humuhumunukunukuapuaa-goes-swimming-by" tabindex="-1">Where the humuhumunukunukuapuaa goes swimming by</h2>
<p>So let’s jump in, script by script and see what happens and how things work.</p>
<p>Here is the link to the <a href="https://demo.flaxjs.net/output/uke.pdf">pdf</a> and to the <a href="https://gitlab.coko.foundation/pagedjs/pagedjs-templates/ukulele-demo">repo</a> if you want to have a proper look at all those files :D).</p>
<p>We’re setting up a place to display the open source templates we’re making, so stay tuned to know more about it.</p>
<h3 id="changes-in-the-dom" tabindex="-1">Changes in the DOM</h3>
<p>Wax, the word processor that fuels Editoria, treats the content as a
flat flow of elements. You can define the type of block from a list of
styles (including custom styles for both inline and block level
elements). The output of that is a nicely set HTML with <code>paragraph</code> with
different classes, <code>header</code>, <code>em</code>, and all the other sweets the HTML has to
offer.</p>
<p>If all is so great, why would we change the DOM?</p>
<p>For multiple reasons:</p>
<ol>
<li>
<p>You may want to bring elements together (for example, when you have
two figures that belong together and for which you want to have a
specific layout), or when you want to nest stuff together, something
that your editor may not offer.</p>
</li>
<li>
<p>To redo something the browsers used to offer (nope, not the CSS
regions, not this time :D) such as the unknown display:
<a href="https://css-tricks.com/run-in/">run-in</a> which allowed us to
push an element to the next as an inline block. This trick has been
used a lot in the world of print, and it was available for the
screen a long time ago. But it didn’t survive the test of time.</p>
</li>
<li>
<p>You may want to create, let’s say, an index. To do so, you need to
create links between the words and their counterparts in the index.
In this book, I used a custom inline class to list everything the
musician talked about in the first chapter to build the list in the
end.</p>
</li>
</ol>
<p>My first script, the <code>contentUkulele.js</code> is happening on the <code>beforeParsed</code>
hook (before any content data has been processed by paged.js). It’s
removing empty elements, add id to elements that don’t have ids yet,
recreate the <code>display: run-in</code> property. Nothing really fancy here, but it
let me create the DOM I want s /I can start designing the book itself.</p>
<h3 id="page-float%3F-are-you-going-to-talk-about-page-float%3F" tabindex="-1">Page-float? Are you going to talk about page-float?</h3>
<p>Yes.</p>
<p>And no.</p>
<p>Not in the way you’re expecting it.</p>
<p>If you want to know what a page-float is, and what it can add to our
layout, you should have a look at the
<a href="http://demos.pagedmedia.org/page-floats/">[demo]{.ul}</a> Julie Blanc
made. Be aware that this is not inside Paged.js (yet) but a good demo on
how things should work when we’ll be able to follow the specs from the
W3C.</p>
<p>Truth is, page-floats are a pretty complex thing (check Julie’s article
<a href="https://www.pagedjs.org/page-floats/">[about page floats]{.ul}</a>). There
are a lot of different ways to implement page-floats, and they all come
with pros and cons. Until we find the universal way of making page-float
a thing, we can still find workarounds and ways of making it work. So
let’s see how I did it for the ukulele book.</p>
<h3 id="the-custom-property-with-its-custom-values" tabindex="-1">The custom property with its custom values</h3>
<p>This image-handling.js script has only one role: find the element that
has that property, and depending on its value, add a specific class to
that element so we can target it when it’s being rendered on the page.
To do so, I created a CSS custom property that can have different values
to define where the element should float.</p>
<pre class="language-css"><code class="language-css"><span class="token property">--page-float</span><span class="token punctuation">:</span> same-top<span class="token punctuation">,</span> same-bottom<span class="token punctuation">,</span> next-top<span class="token punctuation">,</span> next-bottom<span class="token punctuation">,</span> same-column-top<span class="token punctuation">,</span><br>  same-column-bottom<span class="token punctuation">,</span> next-column-top<span class="token punctuation">,</span> next-column-bottom<span class="token punctuation">,</span> full-page<span class="token punctuation">;</span></code></pre>
<p>Some of those values/classes are not used, but are there for the day we
need them.</p>
<h3 id="layout-time!" tabindex="-1">Layout time!</h3>
<p>Then we have a float-top.js, floatNextBis.js or fullPage.js that handles
the moving of elements on the page when they are rendered.</p>
<p>Let’s check the easiest of those scripts: fullPage.js:</p>
<p>First, we define the name of the class for the image full page.</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">const</span> classElemFullPage <span class="token operator">=</span> <span class="token string">"imgFullPage"</span><span class="token punctuation">;</span></code></pre>
<p>Then, we create our hooks like this:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">fullPage</span> <span class="token keyword">extends</span> <span class="token class-name">Paged<span class="token punctuation">.</span>Handler</span> <span class="token punctuation">{</span><br>  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">chunker<span class="token punctuation">,</span> polisher<span class="token punctuation">,</span> caller</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">super</span><span class="token punctuation">(</span>chunker<span class="token punctuation">,</span> polisher<span class="token punctuation">,</span> caller<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>floatFullPage<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>Hooks are sharing the same constructor. That means that if you want to
set a variable and use it in different hooks, you need to set it in the
constructor. In this script, I’m creating a <code>this. floatFullPage</code> that we’re going to use to find the elements that have the <code>--page-float: full-page;</code> custom property.</p>
<pre class="language-js"><code class="language-js"><span class="token function">onDeclaration</span><span class="token punctuation">(</span><span class="token parameter">declaration<span class="token punctuation">,</span> dItem<span class="token punctuation">,</span> dList<span class="token punctuation">,</span> rule</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>declaration<span class="token punctuation">.</span>property <span class="token operator">==</span> <span class="token string">"--page-float"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>declaration<span class="token punctuation">.</span>value<span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"full-page"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">let</span> sel <span class="token operator">=</span> csstree<span class="token punctuation">.</span><span class="token function">generate</span><span class="token punctuation">(</span>rule<span class="token punctuation">.</span>ruleNode<span class="token punctuation">.</span>prelude<span class="token punctuation">)</span><span class="token punctuation">;</span><br>      sel <span class="token operator">=</span> sel<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'[data-id="'</span><span class="token punctuation">,</span> <span class="token string">"#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      sel <span class="token operator">=</span> sel<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'"]'</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token keyword">this</span><span class="token punctuation">.</span>floatFullPage <span class="token operator">=</span> sel<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br>  <span class="token punctuation">}</span></code></pre>
<p><code>onDeclaration</code> is a hook that happens every time a declaration is found.</p>
<p>When that happens, we check if the declaration property is <code>--page-float</code> and if the value is <code>full-page</code>. If that’s the case, we get the value from of the selector (<code>sel</code>) using csstree. And we push that value to the <code>this.floatFullPage</code> array.</p>
<p>Then, when the content is parsed, we use the selectors from <code>this.floatFullPage</code> to add the <code>fullpage</code> class</p>
<pre class="language-js"><code class="language-js"><span class="token function">afterParsed</span><span class="token punctuation">(</span><span class="token parameter">content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>floatFullPage<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>floatFullPage<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">elNBlist</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>      content<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>elNBlist<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>        el<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"imgFullPage"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span></code></pre>
<p>Then, the magic happens: every time a page is done, we run the following script:</p>
<pre class="language-js"><code class="language-js"><span class="token function">afterPageLayout</span><span class="token punctuation">(</span><span class="token parameter">page</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">if</span> <span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".imgFullPage"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">;</span><br>    page<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">"fullPage"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    page<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".imgFullPage"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">"none"</span><span class="token punctuation">;</span><br>    page<span class="token punctuation">.</span>style<span class="token punctuation">.</span>background <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">url(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>page<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">".imgFullPage"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>    page<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundRepeat <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">no-repeat</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>    page<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundSize <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">cover</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>    page<br>      <span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">".pagedjs_margin-content"</span><span class="token punctuation">)</span><br>      <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">marginContent</span><span class="token punctuation">)</span> <span class="token operator">=></span> marginContent<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>When a page has a child with the class <code>full-page</code>, it will hide the image, and use the <code>src</code> attribute of the image and use it as the background for the page. We also put some css styles in there to make sure the background cover the whole page. And one last thing: we remove all the elements in the margin boxes on that page.</p>
<p>The page breaks that arrive before and after are set in the css for the same element.</p>
<p>And the last thing, we register the hook.</p>
<pre class="language-js"><code class="language-js">Paged<span class="token punctuation">.</span><span class="token function">registerHandlers</span><span class="token punctuation">(</span>fullPage<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>We use the exact same idea for the image to top / bottom, but we’re moving them as soon as they’re on the page, and we use the amazing <code>shape-outside</code> property. We’ll cover that deeper in the next installment of this series.</p>
<p>Until then, keep practising music and book design.</p>
<p>The code is accessible <a href="https://gitlab.coko.foundation/pagedjs/pagedjs-templates/ukulele-demo">here</a></p>
<p>Have fun!</p>

  </article>
    

    
      
      
      <aside class="paginator  both ">
        <a class="previous" href="/pagedjs-website/posts/2021-06-newRelease/">Paged.js 0.2.0 Release notes</a>
        <a class="next" href="/pagedjs-website/posts/2020-04-15-starterkits-for-pagedjs/">A collection of starter kits for Paged.js </a>
      </aside>



        
            <footer><p class="foot-content">Paged.js is maintained by the nice folks at
<a href="https://coko.foundation" class="footer-logo">Coko</a>.</p></footer>

        

        
        
        

        
        <script>

        if (document.querySelector('.toc .title')) {
        document.querySelector('.toc .title').addEventListener("click", function() {
        document.querySelector('.toc').classList.toggle("show");
        })
        }

        document.querySelector(".menu-call").addEventListener("click", function() {document.querySelector(".menu").classList.toggle("hide")});


        </script>
        
        <!-- 
        Donation nation
        -->

        <script>
        (function () {
        if (document.querySelector('.commitchange-donate[data-fixed]')) 
        return;
        var cc_donate = document.createElement('div');
        cc_donate.innerHTML = "<a data-fixed class='commitchange-donate'></a>";
        document
        .body
        .appendChild(cc_donate);
        var npo = 5726;
        var script = document.createElement('script');
        var first = document.getElementsByTagName('script')[0];
        script.setAttribute('data-npo-id', npo);
        script.id = 'commitchange-script';
        script.src = 'https://us.commitchange.com/js/donate-button.v2.js';
        first
        .parentNode
        .insertBefore(script, first);
        })();


        </script>
        </body>
        </html>
